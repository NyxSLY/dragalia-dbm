"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const adbkit_1 = require("adbkit");
const fs_1 = require("fs");
const path_1 = require("path");
const util_1 = require("./util");
async function ScreenCap(filename = `${Date.now()}.png`, path = process.cwd()) {
    try {
        const client = adbkit_1.createClient({
            host: '127.0.0.1'
        });
        const list = await client.listDevices();
        const fullpath = path_1.join(path, filename);
        if (fs_1.existsSync(fullpath)) {
            console.log('文件名已存在！建议使用默认名称！');
            return;
        }
        util_1.mkdirsSync(path_1.dirname(fullpath));
        console.log(list);
        if (list.length) {
            const ws = fs_1.createWriteStream(fullpath);
            ws.once('close', () => {
                console.log('截图成功');
            });
            const rs = await client.screencap(list[0].id);
            rs.pipe(ws);
        }
        else {
            console.log('没有设备可以截图！');
        }
    }
    catch (error) {
        console.log(error);
    }
}
exports.ScreenCap = ScreenCap;
;
